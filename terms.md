## Термины и сокращения 

Обратите внимание, к примеру, на разницу между zfs и ZFS:

* ZFS - под этим термином понимается вся система;

* zfs - только файловая система в ZFS (которая опирается на ZPL);

* ZPL - (ZFS POSIX Layer) подсистема, предоставляющая API для работы файловой системы zfs;

* ZVOL - подсистема блочных устройств. В некоторых случаях является синонимом фразы "объект типа DMU_OT_ZVOL";

* zvol - блочное устройство, выделяемое из пула в виде датасета.

* vdev (VDEV) - узел дерева, из которого состоит пул. Если узел является листовым, то это реальное устройство, если нет - виртуальное (mirror, raidz etc);

* SPA - (Storage Pool Allocator) - подсистема, отвечающая за управление занятым/свободным местом в пуле. Оперирует указателями на блоки (blkptr);

* blkptr (BP,БП) - указатель на область/области диска. Может быть пустым (HOLE) и заполненным (FILL);

* ZIO - (ZFS I/O) - подсистема ввода/вывода. Управляет процессом записи/чтения данных с дисков;

* ARC - (Adaptive Replacement Cache) - подсистема, отвечающая за кэширование данных. Через неё проходят все запросы к ZIO;

* arc, l2arc - кэш на чтение первого (память) и второго уровня (диски).

* DMU - (Data Managment Unit) - подсистема, оперирующая объектами ZFS, которые в свою очередь опираются на blkptr'ы. Все объекты описываются при помощи dnode-стуртуры.

* dnode (DN) - (data node) - структура, описывающая некий объект ZFS.

* `*_phys` - суффикс, который соответствует OnDisk-формату. Например, `dnode_phys`, `objset_phys`;

* OnDisk-формат - формат хранения данных непосредственно на физических носителях);

* DSL - (Datasets and Snapshots Layer) - подсистема, оперирующая датасетами и снапшотами. Опирается на DMU.

* ZIL - (ZFS Intent Log) - подсистема, необходимая для обработки синхронных запросов на запись. Может быть представлена в виде устройства SLOG (LogZilla, кэш на запись).

* ZAP - (ZFS Attibute Processor) - подсистема, необходимая для хранения свойств (аттрибутов) различных объектов ZFS, например, свойства файлов или датасетов.

* TXG - (Transaction Group) - группа транзакций. Используется в DMU.

* DBUF - (DMU Buffer) - подсистема, отвечающая за транзакционную запись и COW-механизм.

* Uberblock - блок данных на диске, характеризующий состояние системы на определённый момент времени (точнее - для определённой транзакционной группы).

* ZFS Label - метка на диске/разделе, по которой определяется принадлежность к ZFS.

* `Metaslab, Metaslab Group, Metaslab Class` - объекты, отвечающие за выделение места на в пуле. Хранят информацию о свободном/занятом месте. Имеют OnDisk-формат. Относятся к SPA.

* Indirect blocks - косвенные блоки;

* DVA - (Device Virtual Address) - 128-битный адрес, определяющий область на vdev'е, расположенную по заданному смещению и имеющую заданный размер;

* Gang block - набор блоков небольшого размера, которые предствляются как единый блок. Используются в случае сильной фрагментации;

* BIO (Block IO) - подсистема блочного ввода/выовда ядра Linux;

* NVPair (NVList) - списки пар имя-значение;

* guid - GUID;

* shift - логарифм по основанию 2 для некоторого значения. Например, утверждение "block shift = 9" эквивалентно утверждению "block size = 512b".

* P2PHASE, P2ROUNDUP, P2ALIGN - битовые операции (округление вниз, округление вверх, выравнивание по степеням двойки);

* MOS (Meta Object Set) - объект содержащий информацию о пуле. TODO: уточнить.

* `MetaNode` - метаобъект в датасете или пуле. Содержит в себе дерево, листья которого указывают на объекты датасета/пула. Всегда имеет номер 0;


Часть из предствленных термиров изображена на рис. @fig:zfs-src.

![Диаграмма исходного кода ZFS](./img/zfs-src.png "Диаграмма исходного кода ZFS (1)"){#fig:zfs-src}



